<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Details</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        .detail-box {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 300px;
        }
        .navbar {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Student Details</h1>

    <!-- File Upload -->
    <input type="file" id="excelFile" accept=".xlsx, .xls" onchange="loadDropdown(event)">

    <!-- Student Name Dropdown -->
    <h3>Select Student:</h3>
    <select id="student-name-dropdown" class="detail-box">
        <option value="">-- Select a Student --</option>
    </select>
    <button onclick="searchStudent()">Search</button>

    <!-- Student Details -->
    <h3>Student Information</h3>
    <div>
        <strong>Name:</strong>
        <div id="student-name" class="detail-box">N/A</div>
    </div>
    <div>
        <strong>Class:</strong>
        <div id="student-class" class="detail-box">N/A</div>
    </div>
    <div>
        <strong>Admission Date:</strong>
        <div id="admission-date" class="detail-box">N/A</div>
    </div>
    <div>
        <strong>Admission No:</strong>
        <div id="admission-no" class="detail-box">N/A</div>
    </div>
    <div>
        <strong>Total Pending Fees:</strong>
        <div id="pending-fees" class="detail-box">N/A</div>
    </div>

    <script>
        let studentData = []; // Store Excel data

        // Load Dropdown from Excel
        function loadDropdown(event) {
            const file = event.target.files[0];
            const reader = new FileReader();

            reader.onload = function (e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: "array" });

                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                studentData = XLSX.utils.sheet_to_json(firstSheet); // Load data into global variable

                const dropdown = document.getElementById("student-name-dropdown");
                dropdown.innerHTML = '<option value="">-- Select a Student --</option>'; // Reset dropdown

                // Populate dropdown with student names
                studentData.forEach((row, index) => {
                    if (row["Name"]) {
                        const option = document.createElement("option");
                        option.value = index; // Use index to track the row in Excel data
                        option.textContent = row["Name"];
                        dropdown.appendChild(option);
                    }
                });
            };

            reader.readAsArrayBuffer(file);
        }

        // Search Student and Display Details
        function searchStudent() {
            const selectedIndex = document.getElementById("student-name-dropdown").value;

            if (selectedIndex !== "") {
                const selectedStudent = studentData[selectedIndex]; // Fetch student data by index

                document.getElementById("student-name").textContent = selectedStudent["Name"] || "N/A";
                document.getElementById("student-class").textContent = selectedStudent["Class"] || "N/A";
                document.getElementById("admission-date").textContent = selectedStudent["Admission Date"] || "N/A";
                document.getElementById("admission-no").textContent = selectedStudent["Admission No"] || "N/A";
                document.getElementById("pending-fees").textContent = selectedStudent["Pending Fees"] || "N/A";
            } else {
                alert("Please select a student from the dropdown.");
            }
        }
    </script>
</body>
</html>
